<html>
<head>
</head>
<body>

  <div id="container"> </div>
  <script src="jquery-2.1.1.js"></script>
  <style> .el{
    position: absolute;
  }
  </style>
  <script>
  var elements = [];
  elements.push({id : "A",id_father : "" , top: 250, left: 400})
  elements.push({id : "B",id_father : "A", top: 150, left: 300})
  elements.push({id : "C",id_father : "A", top: 90, left: 120})
  elements.push({id : "D",id_father : "A", top: 500, left: 80})
  elements.push({id : "E",id_father : "A", top: 400, left: 50})
  elements.push({id : "F",id_father : "A", top: 200, left: 90})
  elements.push({id : "G",id_father : "A", top: 300, left: 120})
  elements.push({id : "H",id_father : "A", top: 100, left: 145})


  var lib ={
animate : function(tableau, color)
{
  tableau.forEach(function(el)
{
  $('#'+el.id+'').animate({
    top : ''+el.top+'px', left : ''+el.left+'px'
  },'slow');

  $('#'+el.id+'').css({
    background : ''+color+''
  });
});
},

render : function(tableau, color)
  {
    elements.forEach(function(el)
  {
    var html = "<div id='"+el.id+"' class='el' style='top:"+el.top+"px;left:"+el.left+"px;width:"+Math.floor((Math.random() * 50) + 10)+"; height:"+Math.floor((Math.random() * 50) + 10)+";background:"+color+"'><spam>"+el.id+"</div>";
    $('#container').append(html)
  });
},

GetFather : function(father)
{
  for ( i in elements)
  {
    if ( elements[i].id == father ){
      return elements[i];
    }
  }
},

GetLastChild : function()
{
  return TabChild[(TabChild.length - 1)];
},
GetChilds : function(father)
{
  TabChild = [];
  for ( i in elements)
  {
    if ( elements[i].id_father == father ){
      TabChild.push(elements[i])
    }
  }
  return TabChild;
}
,
GetDeltaXH : function(espaceLeftH)
{
  var espace=0;
  nbrchild = TabChild.length;
  if ( TabChild.length > 0 )
  {
    for ( var a = 0; a < TabChild.length  ; a++ )
    {
      espace = espace +  $("#"+TabChild[a].id+"").width();
    }
  }
  DeltaXH = ((( nbrchild - 1) * espaceLeftH )+ espace ) /2 ;
  return DeltaXH;
},
GetDeltaYH : function(father, espaceTopH)
{
  var plusGrosseBulle = 0;
  for ( z in TabChild)
  {
    if ($("#"+TabChild[z].id+"").height() > plusGrosseBulle )
    {
      plusGrosseBulle = $("#"+TabChild[z].id+"").height();
    }
  }
  DeltaYH = ( ( $("#"+this.GetFather(father).id+"").height() + plusGrosseBulle ) / 2 + espaceTopH );
  return DeltaYH;
},
ChangePositionH : function(father, espaceTopH, espaceLeftH)
{
  for ( j in TabChild )
  {
    TabChild[0].left = this.GetFather(father).left + ( $("#"+this.GetFather(father).id+"").width() /2) - DeltaXH
    if ( j >= 1)
    {
      TabChild[j].left = TabChild[(j-1)].left +  $("#"+TabChild[(j-1)].id+"").width() + espaceLeftH;
    }
    TabChild[j].top = this.GetFather(father).top + DeltaYH
  }
  return TabChild;
},

alignH : function(father, espaceLeftH, espaceTopH )
{
  var TabChild = lib.GetChilds(father);

    var DeltaYH = lib.GetDeltaYH(father, espaceTopH)
    var DeltaXH = lib.GetDeltaXH(espaceLeftH);
    var DeltaYH = 0;
    var DeltaXH = lib.GetDeltaXH(espaceLeftH);

  var TabChildPosition = lib.ChangePositionH(father, espaceTopH, espaceLeftH);
  return TabChildPosition;
},
GetDeltaYV : function(espaceTopV)
{
  var espace=0;
  if ( TabChild.length > 0 )
  {
    espace = ( $("#"+TabChild[0].id+"").height() + $("#"+this.GetLastChild().id+"").height()) / 2;
    for ( a = 1; a < TabChild.length -1; a++ )
    {
      espace = espace +  $("#"+TabChild[a].id+"").height();
    }
  }
  DeltaYV = (( TabChild.length - 1) * espaceTopV + espace ) /2 ;
  return DeltaYV;
},
GetDeltaXV : function(father, espaceLeftV)
{
  var plusGrosseBulle = 0;
  for ( z in TabChild)
  {
    if ($("#"+TabChild[z].id+"").width() > plusGrosseBulle )
    {
      plusGrosseBulle = $("#"+TabChild[z].id+"").width();
    }
  }
  DeltaXV = ( ( $("#"+this.GetFather(father).id+"").width() + plusGrosseBulle ) / 2 + espaceLeftV );
  return DeltaXV;
},
ChangePositionV : function(father, espaceTopV, espaceLeftV)
{
  for ( j in TabChild )
  {
    TabChild[0].top = this.GetFather(father).top + ( $("#"+this.GetFather(father).id+"").height() /2) - DeltaYV
    if ( j >= 1)
    {
      TabChild[j].top = TabChild[(j-1)].top + $("#"+TabChild[(j-1)].id+"").height() + espaceTopV;
    }
    TabChild[j].left = this.GetFather(father).left + DeltaXV
  }
  return TabChild;
},
alignV : function(father, espaceTopV, espaceLeftV)
{
  var TabChild = lib.GetChilds(father);
  var DeltaYV = lib.GetDeltaYV(espaceTopV);
  var DeltaXV = lib.GetDeltaXV(father, espaceLeftV);
  var TabChildPosition = lib.ChangePositionV(father, espaceTopV, espaceLeftV);
  return TabChildPosition;
},
}
</script>
</body>
</html>
